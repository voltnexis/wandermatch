(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{2763:function(e,t,a){Promise.resolve().then(a.bind(a,3659))},3659:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return K}});var l=a(7437),r=a(2265),s=a(9202),i=a(491),n=a(5805),o=a(8997),d=a(2718),c=a(1047),u=a(7877),m=a(8728),x=a(6595),h=a(8837),g=a(7806),f=a(2141),p=a(1265);function b(e){let{user:t,onClose:a}=e,[s,i]=(0,r.useState)({followers:0,following:0,likes:0}),[n,o]=(0,r.useState)([]);return(0,r.useEffect)(()=>{(async()=>{try{let[e,a]=await Promise.all([(0,f.X_)(t.id),(0,f.ww)(t.id)]);i(e),o(a)}catch(e){console.error("Error loading user data:",e)}})()},[t.id]),(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full mx-4",children:[(0,l.jsxs)("div",{className:"text-center mb-6",children:[(0,l.jsx)("div",{className:"w-24 h-24 rounded-full overflow-hidden mx-auto bg-gradient-to-r from-primary-500 to-accent-500 p-1 mb-4",children:(0,l.jsx)("div",{className:"w-full h-full rounded-full overflow-hidden bg-white",children:t.profile_image_url?(0,l.jsx)("img",{src:t.profile_image_url,alt:t.name,className:"w-full h-full object-cover"}):(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center text-primary-500 text-2xl font-bold",children:t.name.charAt(0)})})}),(0,l.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:[t.name,", ",t.age]}),(0,l.jsxs)("p",{className:"text-gray-600 mb-4",children:[t.current_city,", ",t.current_district]}),(0,l.jsxs)("div",{className:"flex justify-center gap-8 mb-6",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-xl font-bold text-gray-800",children:s.followers}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Followers"})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-xl font-bold text-gray-800",children:s.following}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Following"})]})]}),t.bio&&(0,l.jsx)("div",{className:"bg-gray-50 rounded-2xl p-4 mb-6",children:(0,l.jsx)("p",{className:"text-gray-700 text-sm",children:t.bio})}),n.length>0&&(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("h3",{className:"font-semibold text-gray-800 mb-3",children:["Recent Posts (",n.length,")"]}),(0,l.jsx)("div",{className:"space-y-3 max-h-40 overflow-y-auto",children:n.slice(0,3).map(e=>(0,l.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,l.jsx)("p",{className:"text-sm text-gray-700",children:e.content}),e.location_tag&&(0,l.jsxs)("p",{className:"text-xs text-primary-600 mt-1",children:["\uD83D\uDCCD ",e.location_tag]}),(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:new Date(e.created_at).toLocaleDateString()})]},e.id))})]})]}),(0,l.jsx)("button",{onClick:a,className:"w-full bg-gradient-to-r from-gray-500 to-gray-600 text-white py-3 rounded-2xl font-semibold",children:"Close"})]})})}function v(e){let{onSwitchToChat:t}=e,{user:s}=(0,p.a)(),[n,o]=(0,r.useState)([]),[c,u]=(0,r.useState)(!0),[m,v]=(0,r.useState)(null),[j,y]=(0,r.useState)(new Set),[w,N]=(0,r.useState)(new Set);(0,r.useEffect)(()=>{_(),k()},[s]);let _=async()=>{try{let e=(await (0,f.AW)()).filter(e=>e.id!==(null==s?void 0:s.id));o(e)}catch(e){console.error("Error loading travelers:",e)}finally{u(!1)}},k=async()=>{if(null==s?void 0:s.id)try{let e=await (0,f.AW)(),t=new Set;for(let a of e)a.id&&a.id!==s.id&&await (0,f.AJ)(s.id,a.id)&&t.add(a.id);y(t)}catch(e){console.error("Error loading followed users:",e)}};if(c)return(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((e,t)=>(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 animate-pulse",children:[(0,l.jsx)("div",{className:"w-20 h-20 bg-gray-300 rounded-full mx-auto mb-4"}),(0,l.jsx)("div",{className:"h-4 bg-gray-300 rounded mb-2"}),(0,l.jsx)("div",{className:"h-3 bg-gray-300 rounded mb-4"}),(0,l.jsx)("div",{className:"h-8 bg-gray-300 rounded"})]},t))});let D=async e=>{var t;if(!(null==s?void 0:s.id)||w.has(e))return;let a=j.has(e),l=null===(t=n.find(t=>t.id===e))||void 0===t?void 0:t.name;N(t=>new Set(t).add(e));try{a?(await (0,f.F6)(s.id,e),y(t=>{let a=new Set(t);return a.delete(e),a}),alert("Unfollowed ".concat(l,"! \uD83D\uDC4B"))):(await (0,f.P_)(s.id,e),y(t=>new Set(t).add(e)),alert("Following ".concat(l,"! \uD83D\uDC65")))}catch(e){console.error("Error following/unfollowing user:",e),alert("Something went wrong. Please try again.")}finally{N(t=>{let a=new Set(t);return a.delete(e),a})}},C=async e=>{if(null==s?void 0:s.id)try{let{isMutualLike:l,createChatRoom:r}=await Promise.resolve().then(a.bind(a,2141)),i=await l(s.id,e);await r(s.id,e,i),null==t||t()}catch(e){console.error("Error creating chat:",e),alert("Failed to create chat")}};return(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[n.map(e=>(0,l.jsxs)("div",{className:"group bg-white/90 backdrop-blur-md rounded-3xl shadow-xl hover:shadow-2xl transition-all duration-500 p-6 hover:scale-105 border border-gray-100",children:[(0,l.jsxs)("div",{className:"text-center mb-6",children:[(0,l.jsxs)("div",{className:"relative inline-block mb-4",children:[(0,l.jsx)("button",{onClick:()=>v(e),className:"w-24 h-24 rounded-full overflow-hidden mx-auto bg-gradient-to-r from-primary-500 to-accent-500 p-1 hover:scale-105 transition-transform",children:(0,l.jsx)("div",{className:"w-full h-full rounded-full overflow-hidden bg-white",children:e.profile_image_url?(0,l.jsx)("img",{src:e.profile_image_url,alt:e.name,className:"w-full h-full object-cover"}):(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center text-primary-500 text-2xl font-bold",children:e.name.charAt(0)})})}),Math.random()>.6&&(0,l.jsx)("div",{className:"absolute bottom-0 right-0 w-6 h-6 bg-green-500 rounded-full border-3 border-white flex items-center justify-center",children:(0,l.jsx)("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"})})]}),(0,l.jsxs)("h3",{className:"font-display font-bold text-xl text-gray-800 mb-1",children:[e.name,", ",e.age]}),(0,l.jsxs)("div",{className:"flex items-center justify-center text-gray-600 text-sm mb-3",children:[(0,l.jsx)(i.Z,{className:"w-4 h-4 mr-1 text-primary-500"}),(0,l.jsxs)("span",{className:"font-medium",children:[e.current_city,", ",e.current_district]})]}),"free"!==e.subscription_type&&(0,l.jsxs)("div",{className:"inline-flex items-center px-3 py-1 bg-gradient-to-r from-amber-400 to-orange-500 text-white text-xs rounded-full font-semibold mb-3",children:[(0,l.jsx)(x.Z,{className:"w-3 h-3 mr-1"}),"wanderer"===e.subscription_type?"Wanderer ✨":"Guide Pro \uD83D\uDC51"]})]}),e.bio&&(0,l.jsx)("div",{className:"bg-gray-50 rounded-2xl p-4 mb-6",children:(0,l.jsx)("p",{className:"text-gray-700 text-sm text-center line-clamp-3 leading-relaxed",children:e.bio})}),(0,l.jsxs)("div",{className:"flex gap-3",children:[(0,l.jsxs)("button",{onClick:()=>D(e.id),disabled:w.has(e.id),className:"".concat(j.has(e.id)?"flex-1":"w-full"," py-3 px-4 rounded-2xl transition-all duration-300 flex items-center justify-center gap-2 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed ").concat(j.has(e.id)?"bg-gradient-to-r from-gray-500 to-gray-600 text-white hover:from-gray-600 hover:to-gray-700":"bg-gradient-to-r from-green-500 to-teal-500 text-white hover:from-green-600 hover:to-teal-600"),children:[w.has(e.id)?(0,l.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):j.has(e.id)?(0,l.jsx)(h.Z,{className:"w-4 h-4"}):(0,l.jsx)(g.Z,{className:"w-4 h-4"}),w.has(e.id)?"Loading...":j.has(e.id)?"Unfollow":"Follow"]}),j.has(e.id)&&(0,l.jsxs)("button",{onClick:()=>C(e.id),className:"flex-1 bg-gradient-to-r from-blue-500 to-purple-500 text-white py-3 px-4 rounded-2xl hover:from-blue-600 hover:to-purple-600 transition-all duration-300 flex items-center justify-center gap-2 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105",children:[(0,l.jsx)(d.Z,{className:"w-4 h-4"}),"Chat"]})]})]},e.id)),0===n.length&&!c&&(0,l.jsxs)("div",{className:"col-span-full text-center py-12",children:[(0,l.jsx)("div",{className:"text-gray-400 text-lg",children:"No travelers found"}),(0,l.jsx)("p",{className:"text-gray-500 mt-2",children:"Check back later for new connections!"})]}),m&&(0,l.jsx)(b,{user:m,onClose:()=>v(null)})]})}let j=e=>e?e.replace(/[<>]/g,"").replace(/["']/g,"").replace(/&/g,"&amp;").trim():"";var y=a(2489),w=a(2369);function N(e){let{userId:t,onClose:a}=e,[s,n]=(0,r.useState)(null),[o,d]=(0,r.useState)({followers:0,following:0,likes:0}),[c,u]=(0,r.useState)([]),[m,x]=(0,r.useState)([]),[h,g]=(0,r.useState)([]),[p,b]=(0,r.useState)([]),[v,N]=(0,r.useState)("posts"),[_,k]=(0,r.useState)(!0);(0,r.useEffect)(()=>{D()},[t]);let D=async()=>{try{let[e,a,l,r,s,i]=await Promise.all([(0,f.GA)(t),(0,f.X_)(t),(0,f.ww)(t),(0,f.ET)(t),(0,f.nX)(t),(0,f.xT)(t)]);n(e),d(a),u(l),x(r),g(s),b(i)}catch(e){console.error("Error loading user data:",e)}finally{k(!1)}};return _?(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsx)("div",{className:"bg-white rounded-3xl p-8 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:(0,l.jsxs)("div",{className:"animate-pulse",children:[(0,l.jsx)("div",{className:"w-24 h-24 bg-gray-300 rounded-full mx-auto mb-4"}),(0,l.jsx)("div",{className:"h-6 bg-gray-300 rounded mb-2"}),(0,l.jsx)("div",{className:"h-4 bg-gray-300 rounded mb-4"})]})})}):(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-3xl p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold",children:"Profile"}),(0,l.jsx)("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded-full",children:(0,l.jsx)(y.Z,{className:"w-6 h-6"})})]}),(0,l.jsxs)("div",{className:"text-center mb-6",children:[(0,l.jsx)("div",{className:"w-24 h-24 rounded-full overflow-hidden mx-auto mb-4 bg-gradient-to-r from-blue-500 to-purple-500 p-1",children:(0,l.jsx)("div",{className:"w-full h-full rounded-full overflow-hidden bg-white",children:(null==s?void 0:s.profile_image_url)?(0,l.jsx)("img",{src:s.profile_image_url,alt:s.name,className:"w-full h-full object-cover"}):(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center text-blue-500",children:(0,l.jsx)(w.Z,{className:"w-12 h-12"})})})}),(0,l.jsxs)("h3",{className:"text-xl font-bold mb-1",children:[j(null==s?void 0:s.name),", ",null==s?void 0:s.age]}),(0,l.jsxs)("div",{className:"flex items-center justify-center text-gray-600 mb-4",children:[(0,l.jsx)(i.Z,{className:"w-4 h-4 mr-1"}),(0,l.jsxs)("span",{children:[j(null==s?void 0:s.current_city),", ",j(null==s?void 0:s.current_district)]})]}),(null==s?void 0:s.bio)&&(0,l.jsx)("p",{className:"text-gray-700 mb-4",children:j(s.bio)}),(0,l.jsxs)("div",{className:"flex justify-center gap-8 mb-6",children:[(0,l.jsxs)("button",{onClick:()=>N("followers"),className:"text-center p-2 rounded-lg ".concat("followers"===v?"bg-blue-50":"hover:bg-gray-50"),children:[(0,l.jsx)("div",{className:"text-xl font-bold",children:o.followers}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Followers"})]}),(0,l.jsxs)("button",{onClick:()=>N("following"),className:"text-center p-2 rounded-lg ".concat("following"===v?"bg-blue-50":"hover:bg-gray-50"),children:[(0,l.jsx)("div",{className:"text-xl font-bold",children:o.following}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Following"})]}),(0,l.jsxs)("button",{onClick:()=>N("posts"),className:"text-center p-2 rounded-lg ".concat("posts"===v?"bg-blue-50":"hover:bg-gray-50"),children:[(0,l.jsx)("div",{className:"text-xl font-bold",children:c.length}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Posts"})]}),(0,l.jsxs)("button",{onClick:()=>N("travel"),className:"text-center p-2 rounded-lg ".concat("travel"===v?"bg-blue-50":"hover:bg-gray-50"),children:[(0,l.jsx)("div",{className:"text-xl font-bold",children:p.length}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Travel Plans"})]}),(0,l.jsxs)("button",{onClick:()=>N("kerala"),className:"text-center p-2 rounded-lg ".concat("kerala"===v?"bg-blue-50":"hover:bg-gray-50"),children:[(0,l.jsx)("div",{className:"text-xl font-bold",children:"\uD83C\uDF34"}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Kerala"})]})]})]}),(0,l.jsxs)("div",{className:"max-h-64 overflow-y-auto",children:["posts"===v&&(0,l.jsxs)("div",{className:"space-y-4",children:[c.map(e=>(0,l.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,l.jsx)("p",{className:"text-gray-800",children:j(e.content)}),e.location_tag&&(0,l.jsxs)("div",{className:"flex items-center mt-2 text-sm text-gray-600",children:[(0,l.jsx)(i.Z,{className:"w-3 h-3 mr-1"}),j(e.location_tag)]}),(0,l.jsx)("div",{className:"text-xs text-gray-500 mt-2",children:new Date(e.created_at).toLocaleDateString()})]},e.id)),0===c.length&&(0,l.jsx)("div",{className:"text-center text-gray-500 py-8",children:"No posts yet"})]}),"followers"===v&&(0,l.jsxs)("div",{className:"space-y-3",children:[m.map(e=>(0,l.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white font-bold",children:e.name.charAt(0)}),(0,l.jsx)("span",{className:"font-medium",children:j(e.name)})]},e.id)),0===m.length&&(0,l.jsx)("div",{className:"text-center text-gray-500 py-8",children:"No followers yet"})]}),"following"===v&&(0,l.jsxs)("div",{className:"space-y-3",children:[h.map(e=>(0,l.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-green-500 to-teal-500 rounded-full flex items-center justify-center text-white font-bold",children:e.name.charAt(0)}),(0,l.jsx)("span",{className:"font-medium",children:j(e.name)})]},e.id)),0===h.length&&(0,l.jsx)("div",{className:"text-center text-gray-500 py-8",children:"Not following anyone yet"})]}),"travel"===v&&(0,l.jsxs)("div",{className:"space-y-4",children:[p.map(e=>(0,l.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-4 border border-blue-200",children:[(0,l.jsx)("h4",{className:"font-semibold text-blue-800",children:j(e.destination)}),(0,l.jsx)("p",{className:"text-sm text-blue-600",children:j(e.district)}),(0,l.jsxs)("div",{className:"flex justify-between text-xs text-gray-600 mt-2",children:[(0,l.jsx)("span",{children:new Date(e.start_date).toLocaleDateString()}),(0,l.jsx)("span",{children:new Date(e.end_date).toLocaleDateString()})]}),e.description&&(0,l.jsx)("p",{className:"text-sm text-gray-700 mt-2",children:j(e.description)})]},e.id)),0===p.length&&(0,l.jsx)("div",{className:"text-center text-gray-500 py-8",children:"No travel plans yet"})]}),"kerala"===v&&(0,l.jsxs)("div",{className:"text-center py-8",children:[(0,l.jsx)("div",{className:"text-4xl mb-4",children:"\uD83C\uDF34"}),(0,l.jsx)("div",{className:"text-gray-600",children:"Kerala Explorer"}),(0,l.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Discover God's Own Country"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-6",children:[(0,l.jsxs)("div",{className:"bg-green-50 rounded-lg p-3 border border-green-200",children:[(0,l.jsx)("div",{className:"text-2xl mb-1",children:"\uD83D\uDEA4"}),(0,l.jsx)("div",{className:"text-sm font-medium text-green-800",children:"Backwaters"})]}),(0,l.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-200",children:[(0,l.jsx)("div",{className:"text-2xl mb-1",children:"⛰️"}),(0,l.jsx)("div",{className:"text-sm font-medium text-blue-800",children:"Hill Stations"})]}),(0,l.jsxs)("div",{className:"bg-yellow-50 rounded-lg p-3 border border-yellow-200",children:[(0,l.jsx)("div",{className:"text-2xl mb-1",children:"\uD83C\uDFD6️"}),(0,l.jsx)("div",{className:"text-sm font-medium text-yellow-800",children:"Beaches"})]}),(0,l.jsxs)("div",{className:"bg-purple-50 rounded-lg p-3 border border-purple-200",children:[(0,l.jsx)("div",{className:"text-2xl mb-1",children:"\uD83C\uDFDB️"}),(0,l.jsx)("div",{className:"text-sm font-medium text-purple-800",children:"Cultural"})]})]})]})]})]})})}function _(e){let{onSwitchToChat:t}=e,{user:a}=(0,p.a)(),[s,n]=(0,r.useState)("liked"),[o,c]=(0,r.useState)([]),[u,m]=(0,r.useState)([]),[x,h]=(0,r.useState)(!0),[g,b]=(0,r.useState)(null);(0,r.useEffect)(()=>{(null==a?void 0:a.id)&&v()},[a]);let v=async()=>{if(null==a?void 0:a.id)try{let[e,t]=await Promise.all([(0,f.DJ)(a.id),(0,f.Bp)(a.id)]);c(e);let l=[];for(let e of t)await (0,f.ip)(a.id,e.id)&&l.push(e);m(l)}catch(e){console.error("Error loading matches:",e)}finally{h(!1)}},y=async e=>{if(null==a?void 0:a.id)try{let l=u.some(t=>t.id===e),r=await (0,f.createChatRoom)(a.id,e,l);localStorage.setItem("wandermatch-selected-chat",r.id),t&&t()}catch(e){console.error("Error creating chat:",e)}};if(x)return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,l.jsx)("div",{className:"h-10 w-24 bg-gray-300 rounded-full animate-pulse"}),(0,l.jsx)("div",{className:"h-10 w-32 bg-gray-300 rounded-full animate-pulse"})]}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[void 0,void 0,void 0].map((e,t)=>(0,l.jsxs)("div",{className:"bg-white rounded-3xl p-6 animate-pulse",children:[(0,l.jsx)("div",{className:"w-20 h-20 bg-gray-300 rounded-full mx-auto mb-4"}),(0,l.jsx)("div",{className:"h-4 bg-gray-300 rounded mb-2"}),(0,l.jsx)("div",{className:"h-3 bg-gray-300 rounded"})]},t))})]});let w="liked"===s?o:u;return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsxs)("button",{onClick:()=>n("liked"),className:"px-6 py-3 rounded-full font-semibold transition-all ".concat("liked"===s?"bg-gradient-to-r from-pink-500 to-red-500 text-white shadow-lg":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-200"),children:["\uD83D\uDC95 Liked (",o.length,")"]}),(0,l.jsxs)("button",{onClick:()=>n("likedback"),className:"px-6 py-3 rounded-full font-semibold transition-all ".concat("likedback"===s?"bg-gradient-to-r from-pink-500 to-red-500 text-white shadow-lg":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-200"),children:["\uD83D\uDC96 Liked Back (",u.length,")"]})]}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:w.map(e=>(0,l.jsxs)("div",{className:"bg-white/90 backdrop-blur-md rounded-3xl shadow-xl hover:shadow-2xl transition-all duration-500 p-6 border border-pink-100",children:[(0,l.jsxs)("div",{className:"text-center mb-6",children:[(0,l.jsxs)("button",{onClick:()=>b(e.id),className:"relative inline-block mb-4",children:[(0,l.jsx)("div",{className:"w-24 h-24 rounded-full overflow-hidden mx-auto bg-gradient-to-r from-pink-500 to-red-500 p-1",children:(0,l.jsx)("div",{className:"w-full h-full rounded-full overflow-hidden bg-white",children:e.profile_image_url?(0,l.jsx)("img",{src:e.profile_image_url,alt:e.name,className:"w-full h-full object-cover"}):(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center text-pink-500 text-2xl font-bold",children:e.name.charAt(0)})})}),"likedback"===s&&(0,l.jsx)("div",{className:"absolute -top-1 -right-1 w-8 h-8 bg-red-500 rounded-full flex items-center justify-center animate-pulse",children:"\uD83D\uDC95"})]}),(0,l.jsxs)("h3",{className:"font-display font-bold text-xl text-gray-800 mb-1",children:[j(e.name),", ",e.age]}),(0,l.jsxs)("div",{className:"flex items-center justify-center text-gray-600 text-sm mb-3",children:[(0,l.jsx)(i.Z,{className:"w-4 h-4 mr-1 text-pink-500"}),(0,l.jsxs)("span",{children:[j(e.current_city),", ",j(e.current_district)]})]})]}),e.bio&&(0,l.jsx)("div",{className:"bg-pink-50 rounded-2xl p-4 mb-6 border border-pink-200",children:(0,l.jsx)("p",{className:"text-gray-700 text-sm text-center line-clamp-3",children:j(e.bio)})}),(0,l.jsx)("div",{className:"flex gap-2",children:(0,l.jsxs)("button",{onClick:()=>y(e.id),className:"flex-1 py-3 px-4 rounded-2xl transition-all duration-300 flex items-center justify-center gap-2 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105 ".concat("likedback"===s?"bg-gradient-to-r from-pink-500 to-red-500 text-white hover:from-pink-600 hover:to-red-600":"bg-gradient-to-r from-blue-500 to-purple-500 text-white hover:from-blue-600 hover:to-purple-600"),children:[(0,l.jsx)(d.Z,{className:"w-4 h-4"}),"likedback"===s?"\uD83D\uDC95 Romantic Chat":"Chat"]})})]},e.id))}),0===w.length&&(0,l.jsxs)("div",{className:"text-center py-12",children:[(0,l.jsx)("div",{className:"text-6xl mb-4",children:"liked"===s?"\uD83D\uDC95":"\uD83D\uDC96"}),(0,l.jsx)("div",{className:"text-gray-400 text-lg",children:"liked"===s?"No one liked yet":"No mutual likes yet"}),(0,l.jsx)("p",{className:"text-gray-500 mt-2",children:"liked"===s?"Start liking travelers to see them here!":"When someone likes you back, they'll appear here!"})]}),g&&(0,l.jsx)(N,{userId:g,onClose:()=>b(null)})]})}function k(e){let{onSwitchToChat:t}=e,{user:a}=(0,p.a)(),[s,n]=(0,r.useState)([]),[c,u]=(0,r.useState)(!0),[m,x]=(0,r.useState)(new Set),[g,b]=(0,r.useState)(new Set);(0,r.useEffect)(()=>{(null==a?void 0:a.id)&&(v(),y())},[a]);let v=async()=>{if(!(null==a?void 0:a.id)){u(!1);return}try{let e=await (0,f.nX)(a.id);n(e)}catch(e){console.error("Error loading following:",e)}finally{u(!1)}},y=async()=>{if(null==a?void 0:a.id)try{let e=new Set;for(let t of s)t.id&&await (0,f.ip)(a.id,t.id)&&e.add(t.id);x(e)}catch(e){console.error("Error loading liked users:",e)}};(0,r.useEffect)(()=>{s.length>0&&y()},[s,a]);let w=async e=>{var t;if(!(null==a?void 0:a.id)||g.has(e))return;let l=null===(t=s.find(t=>t.id===e))||void 0===t?void 0:t.name;if(confirm("Unfollow ".concat(l,"?"))){b(t=>new Set(t).add(e));try{await (0,f.F6)(a.id,e),n(s.filter(t=>t.id!==e)),x(t=>{let a=new Set(t);return a.delete(e),a}),alert("Unfollowed ".concat(l,"! \uD83D\uDC4B"))}catch(e){console.error("Error unfollowing user:",e),alert("Something went wrong. Please try again.")}finally{b(t=>{let a=new Set(t);return a.delete(e),a})}}},N=async e=>{var t;if(!(null==a?void 0:a.id)||g.has(e))return;let l=m.has(e),r=null===(t=s.find(t=>t.id===e))||void 0===t?void 0:t.name;b(t=>new Set(t).add(e));try{l?(await (0,f.oB)(a.id,e),x(t=>{let a=new Set(t);return a.delete(e),a}),alert("Unliked ".concat(r,"! \uD83D\uDC94"))):(await (0,f.EF)(a.id,e),x(t=>new Set(t).add(e)),alert("Liked ".concat(r,"! \uD83D\uDC96")))}catch(e){console.error("Error liking/unliking user:",e),alert("Something went wrong. Please try again.")}finally{b(t=>{let a=new Set(t);return a.delete(e),a})}},_=async(e,t)=>{var l;if(!(null==a?void 0:a.id))return;let r=null===(l=s.find(t=>t.id===e))||void 0===l?void 0:l.name,i=m.has(e);try{let l=await (0,f.createChatRoom)(a.id,e,i);localStorage.setItem("wandermatch-selected-chat",l.id),t?t():alert("Chat created with ".concat(r,"! Go to Messages tab to start chatting! ").concat(i?"\uD83D\uDC95":"\uD83D\uDCAC"))}catch(e){console.error("Error creating chat:",e),alert("Failed to create chat")}};return c?(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[void 0,void 0,void 0].map((e,t)=>(0,l.jsxs)("div",{className:"bg-white rounded-3xl shadow-lg p-6 animate-pulse",children:[(0,l.jsx)("div",{className:"w-20 h-20 bg-gray-300 rounded-full mx-auto mb-4"}),(0,l.jsx)("div",{className:"h-4 bg-gray-300 rounded mb-2"}),(0,l.jsx)("div",{className:"h-3 bg-gray-300 rounded mb-4"}),(0,l.jsx)("div",{className:"h-8 bg-gray-300 rounded"})]},t))}):(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[s.map(e=>(0,l.jsxs)("div",{className:"group bg-white/90 backdrop-blur-md rounded-3xl shadow-xl hover:shadow-2xl transition-all duration-500 p-6 hover:scale-105 border border-gray-100",children:[(0,l.jsxs)("div",{className:"text-center mb-6",children:[(0,l.jsxs)("div",{className:"relative inline-block mb-4",children:[(0,l.jsx)("div",{className:"w-24 h-24 rounded-full overflow-hidden mx-auto bg-gradient-to-r from-blue-500 to-purple-500 p-1",children:(0,l.jsx)("div",{className:"w-full h-full rounded-full overflow-hidden bg-white",children:e.profile_image_url?(0,l.jsx)("img",{src:e.profile_image_url,alt:e.name,className:"w-full h-full object-cover"}):(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center text-blue-500 text-2xl font-bold",children:e.name.charAt(0)})})}),e.is_online&&(0,l.jsx)("div",{className:"absolute bottom-0 right-0 w-6 h-6 bg-green-500 rounded-full border-3 border-white flex items-center justify-center",children:(0,l.jsx)("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"})})]}),(0,l.jsxs)("h3",{className:"font-display font-bold text-xl text-gray-800 mb-1",children:[j(e.name)||"Unknown",", ",e.age]}),(0,l.jsxs)("div",{className:"flex items-center justify-center text-gray-600 text-sm mb-3",children:[(0,l.jsx)(i.Z,{className:"w-4 h-4 mr-1 text-primary-500"}),(0,l.jsxs)("span",{className:"font-medium",children:[j(e.current_city)||"Unknown",",",j(e.current_district)||"Unknown"]})]})]}),e.bio&&(0,l.jsx)("div",{className:"bg-gray-50 rounded-2xl p-4 mb-6",children:(0,l.jsx)("p",{className:"text-gray-700 text-sm text-center line-clamp-3 leading-relaxed",children:j(e.bio)})}),(0,l.jsxs)("div",{className:"flex gap-2 mb-3",children:[(0,l.jsxs)("button",{onClick:()=>N(e.id),disabled:g.has(e.id),className:"flex-1 py-3 px-4 rounded-2xl transition-all duration-300 flex items-center justify-center gap-2 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed ".concat(m.has(e.id)?"bg-gradient-to-r from-gray-500 to-gray-600 text-white hover:from-gray-600 hover:to-gray-700":"bg-gradient-to-r from-red-500 to-pink-500 text-white hover:from-red-600 hover:to-pink-600"),children:[g.has(e.id)?(0,l.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):(0,l.jsx)(o.Z,{className:"w-4 h-4"}),g.has(e.id)?"Loading...":m.has(e.id)?"Unlike":"Like"]}),(0,l.jsxs)("button",{onClick:()=>_(e.id,t),className:"flex-1 py-3 px-4 rounded-2xl transition-all duration-300 flex items-center justify-center gap-2 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105 ".concat(m.has(e.id)?"bg-gradient-to-r from-pink-500 to-red-500 text-white hover:from-pink-600 hover:to-red-600":"bg-gradient-to-r from-blue-500 to-purple-500 text-white hover:from-blue-600 hover:to-purple-600"),children:[(0,l.jsx)(d.Z,{className:"w-4 h-4"}),m.has(e.id)?"\uD83D\uDC95 Chat":"Chat"]})]}),(0,l.jsxs)("button",{onClick:()=>w(e.id),disabled:g.has(e.id),className:"w-full bg-gradient-to-r from-gray-500 to-gray-600 text-white py-2 px-4 rounded-2xl hover:from-gray-600 hover:to-gray-700 transition-all duration-300 flex items-center justify-center gap-2 font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:[g.has(e.id)?(0,l.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):(0,l.jsx)(h.Z,{className:"w-4 h-4"}),g.has(e.id)?"Loading...":"Unfollow"]})]},e.id)),0===s.length&&!c&&(0,l.jsxs)("div",{className:"col-span-full text-center py-12",children:[(0,l.jsx)("div",{className:"text-gray-400 text-lg",children:"You're not following anyone yet"}),(0,l.jsx)("p",{className:"text-gray-500 mt-2",children:"Start following travelers to see them here!"})]})]})}function D(){let{user:e}=(0,p.a)(),[t,a]=(0,r.useState)([]),[s,n]=(0,r.useState)(!0),[o,d]=(0,r.useState)({}),[c,u]=(0,r.useState)(null),[m,x]=(0,r.useState)(new Set);(0,r.useEffect)(()=>{h()},[]);let h=async()=>{if(!(null==e?void 0:e.id)){n(!1);return}try{let t=(await (0,f.AW)()).filter(t=>t.is_online&&t.id!==e.id);a(t);let l={};for(let a of t){let t=await (0,f.AJ)(e.id,a.id);l[a.id]=t}d(l)}catch(e){console.error("Error loading online users:",e)}finally{n(!1)}},b=e=>{u(e)},v=async a=>{var l;if(!(null==e?void 0:e.id)||m.has(a))return;let r=null===(l=t.find(e=>e.id===a))||void 0===l?void 0:l.name,s=o[a];x(e=>new Set(e).add(a));try{s?alert("You're already following ".concat(r,"!")):(await (0,f.P_)(e.id,a),d(e=>({...e,[a]:!0})),alert("Now following ".concat(r,"! \uD83C\uDF89")))}catch(e){console.error("Error following user:",e),alert("Something went wrong. Please try again.")}finally{x(e=>{let t=new Set(e);return t.delete(a),t})}};return s?(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(8)].map((e,t)=>(0,l.jsxs)("div",{className:"bg-white/90 rounded-2xl p-4 animate-pulse",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-gray-300 rounded-full mx-auto mb-2"}),(0,l.jsx)("div",{className:"h-3 bg-gray-300 rounded mb-1"}),(0,l.jsx)("div",{className:"h-2 bg-gray-300 rounded"})]},t))}):(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"mb-6 text-center",children:(0,l.jsxs)("div",{className:"inline-flex items-center px-4 py-2 bg-green-100 text-green-700 rounded-full font-semibold",children:[(0,l.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full mr-2 animate-pulse"}),t.length," travelers online now"]})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.map(e=>(0,l.jsx)("div",{className:"bg-white/90 backdrop-blur-md rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 p-4 hover:scale-105 border border-gray-100",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsxs)("div",{className:"relative inline-block mb-3",children:[(0,l.jsx)("div",{className:"w-16 h-16 rounded-full overflow-hidden mx-auto bg-gradient-to-r from-green-500 to-teal-500 p-1",children:(0,l.jsx)("div",{className:"w-full h-full rounded-full overflow-hidden bg-white",children:e.profile_image_url?(0,l.jsx)("img",{src:e.profile_image_url,alt:e.name,className:"w-full h-full object-cover"}):(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center text-green-500 text-lg font-bold",children:e.name.charAt(0)})})}),(0,l.jsx)("div",{className:"absolute -bottom-1 -right-1 w-5 h-5 bg-green-500 rounded-full border-2 border-white flex items-center justify-center",children:(0,l.jsx)("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"})})]}),(0,l.jsx)("h3",{className:"font-semibold text-sm text-gray-800 mb-1",children:e.name}),(0,l.jsxs)("div",{className:"flex items-center justify-center text-gray-600 text-xs mb-3",children:[(0,l.jsx)(i.Z,{className:"w-3 h-3 mr-1 text-green-500"}),(0,l.jsx)("span",{children:e.current_city})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)("button",{onClick:()=>b(e.id),className:"flex-1 bg-gradient-to-r from-gray-500 to-gray-600 text-white py-2 px-3 rounded-xl hover:from-gray-600 hover:to-gray-700 transition-all duration-300 flex items-center justify-center gap-1 text-xs font-semibold",children:[(0,l.jsx)(w.Z,{className:"w-3 h-3"}),"View"]}),(0,l.jsxs)("button",{onClick:()=>v(e.id),disabled:m.has(e.id),className:"flex-1 py-2 px-3 rounded-xl transition-all duration-300 flex items-center justify-center gap-1 text-xs font-semibold disabled:opacity-50 ".concat(o[e.id]?"bg-gradient-to-r from-green-500 to-teal-500 text-white hover:from-green-600 hover:to-teal-600":"bg-gradient-to-r from-blue-500 to-purple-500 text-white hover:from-blue-600 hover:to-purple-600"),children:[m.has(e.id)?(0,l.jsx)("div",{className:"w-3 h-3 border border-white border-t-transparent rounded-full animate-spin"}):(0,l.jsx)(g.Z,{className:"w-3 h-3"}),m.has(e.id)?"Loading...":o[e.id]?"Following":"Follow"]})]})]})},e.id)),0===t.length&&!s&&(0,l.jsxs)("div",{className:"col-span-full text-center py-12",children:[(0,l.jsx)("div",{className:"text-gray-400 text-lg",children:"No one is online right now"}),(0,l.jsx)("p",{className:"text-gray-500 mt-2",children:"Check back later to see who's exploring!"})]})]}),c&&(0,l.jsx)(N,{userId:c,onClose:()=>u(null)})]})}var C=a(4743);function S(){let{user:e}=(0,p.a)(),[t,a]=(0,r.useState)([]),[s,i]=(0,r.useState)(null),[n,o]=(0,r.useState)([]),[d,c]=(0,r.useState)(""),[u,m]=(0,r.useState)(!0),x=(0,r.useRef)(null);(0,r.useEffect)(()=>{(null==e?void 0:e.id)&&h()},[e]),(0,r.useEffect)(()=>{s&&g()},[s]),(0,r.useEffect)(()=>{v()},[n]);let h=async()=>{if(null==e?void 0:e.id)try{let t=await (0,f.di)(e.id);a(t),t.length>0&&!s&&i(t[0])}catch(e){console.error("Error loading chat rooms:",e)}finally{m(!1)}},g=async()=>{if(s)try{let e=await (0,f.b6)(s.id);o(e)}catch(e){console.error("Error loading messages:",e)}},b=async()=>{if(d.trim()&&s&&(null==e?void 0:e.id))try{await (0,f.bE)(s.id,e.id,d),c(""),g(),h()}catch(e){console.error("Error sending message:",e)}},v=()=>{var e;null===(e=x.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},j=t=>t.participant1.id===(null==e?void 0:e.id)?t.participant2:t.participant1;return u?(0,l.jsx)("div",{className:"bg-white rounded-3xl shadow-xl h-[600px] flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Loading chats..."})]})}):(0,l.jsxs)("div",{className:"rounded-3xl shadow-xl overflow-hidden h-[600px] flex ".concat((null==s?void 0:s.is_romantic)?"bg-gradient-to-br from-pink-100 via-red-50 to-pink-100 border-2 border-pink-300":"bg-white"),children:[(0,l.jsxs)("div",{className:"w-1/3 border-r ".concat((null==s?void 0:s.is_romantic)?"border-pink-300 bg-pink-50/50":"border-gray-200"),children:[(0,l.jsx)("div",{className:"p-6 border-b ".concat((null==s?void 0:s.is_romantic)?"border-pink-200 bg-gradient-to-r from-pink-100 to-red-100":"border-gray-200"),children:(0,l.jsx)("h2",{className:"text-xl font-bold mb-4 ".concat((null==s?void 0:s.is_romantic)?"text-pink-800":""),children:(null==s?void 0:s.is_romantic)?"\uD83D\uDC95 Messages \uD83D\uDC95":"Messages"})}),(0,l.jsx)("div",{className:"overflow-y-auto h-full",children:0===t.length?(0,l.jsxs)("div",{className:"p-4 text-center text-gray-500",children:[(0,l.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDCAC"}),(0,l.jsx)("p",{children:"No conversations yet"})]}):t.map(e=>{let t=j(e);return(0,l.jsx)("div",{onClick:()=>i(e),className:"p-4 border-b cursor-pointer transition-colors ".concat((null==s?void 0:s.id)===e.id?e.is_romantic?"bg-gradient-to-r from-pink-50 to-red-50 border-pink-200":"bg-blue-50 border-blue-200":e.is_romantic?"border-pink-100 hover:bg-pink-50":"border-gray-100 hover:bg-gray-50"),children:(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsxs)("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-white text-xl relative ".concat(e.is_romantic?"bg-gradient-to-r from-pink-400 to-red-400":"bg-gradient-to-r from-blue-400 to-purple-400"),children:[t.name.charAt(0),e.is_romantic&&(0,l.jsx)("div",{className:"absolute -top-1 -right-1 w-6 h-6 bg-red-500 rounded-full flex items-center justify-center text-xs animate-pulse",children:"\uD83D\uDC95"})]}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsxs)("div",{className:"font-semibold truncate ".concat(e.is_romantic?"text-pink-700":""),children:[t.name," ",e.is_romantic?"\uD83D\uDC95":""]}),(0,l.jsx)("div",{className:"text-sm text-gray-600 truncate",children:e.last_message||"Start a conversation"})]})]})},e.id)})})]}),(0,l.jsx)("div",{className:"flex-1 flex flex-col",children:s?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"p-4 border-b ".concat(s.is_romantic?"bg-gradient-to-r from-pink-100 to-red-100 border-pink-200":"bg-gray-50 border-gray-200"),children:(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-400 to-purple-400 rounded-full flex items-center justify-center text-white",children:j(s).name.charAt(0)}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"font-semibold ".concat(s.is_romantic?"text-pink-700":""),children:[j(s).name,s.is_romantic&&" \uD83D\uDC95"]}),(0,l.jsx)("div",{className:"text-sm ".concat(s.is_romantic?"text-pink-600":"text-gray-600"),children:"Online now"})]})]})}),(0,l.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 relative ".concat(s.is_romantic?"bg-gradient-to-b from-pink-50 via-red-50 to-pink-50":"bg-white"),children:[s.is_romantic&&(0,l.jsxs)("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:[(0,l.jsx)("div",{className:"absolute top-10 left-10 text-pink-200 text-4xl animate-pulse",children:"\uD83D\uDC95"}),(0,l.jsx)("div",{className:"absolute top-20 right-20 text-red-200 text-3xl animate-bounce",children:"❤️"}),(0,l.jsx)("div",{className:"absolute top-40 left-1/4 text-pink-300 text-2xl animate-pulse",children:"\uD83D\uDC96"}),(0,l.jsx)("div",{className:"absolute top-60 right-1/3 text-red-300 text-3xl animate-bounce",children:"\uD83D\uDC9D"}),(0,l.jsx)("div",{className:"absolute bottom-40 left-20 text-pink-200 text-4xl animate-pulse",children:"\uD83D\uDC97"}),(0,l.jsx)("div",{className:"absolute bottom-20 right-10 text-red-200 text-2xl animate-bounce",children:"\uD83D\uDC98"}),(0,l.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-pink-100 text-6xl animate-pulse opacity-30",children:"\uD83D\uDC95"})]}),s.is_romantic&&(0,l.jsx)("div",{className:"text-center py-3 relative z-10",children:(0,l.jsx)("div",{className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-pink-300 to-red-300 rounded-full text-white text-lg font-bold shadow-lg animate-pulse",children:"\uD83D\uDC95 ROMANTIC CHAT MODE \uD83D\uDC95"})}),n.map(t=>t.sender&&"system"!==t.message_type?(0,l.jsx)("div",{className:"flex ".concat(t.sender.id===(null==e?void 0:e.id)?"justify-end":"justify-start"),children:(0,l.jsxs)("div",{className:"max-w-xs lg:max-w-md px-4 py-2 rounded-2xl ".concat(t.sender.id===(null==e?void 0:e.id)?s.is_romantic?"bg-gradient-to-r from-pink-500 to-red-500 text-white":"bg-blue-500 text-white":s.is_romantic?"bg-gradient-to-r from-pink-100 to-red-100 text-gray-900 border border-pink-200":"bg-gray-100 text-gray-900"),children:[(0,l.jsx)("div",{className:"text-sm",children:t.content}),(0,l.jsx)("div",{className:"text-xs mt-1 opacity-75",children:new Date(t.created_at).toLocaleTimeString()})]})},t.id):(0,l.jsx)("div",{className:"flex justify-center my-4",children:(0,l.jsxs)("div",{className:"bg-gradient-to-r from-purple-500 to-indigo-500 text-white px-6 py-3 rounded-full text-sm font-medium shadow-lg max-w-md text-center",children:["\uD83D\uDC95 ",t.content," \uD83D\uDC95"]})},t.id)),(0,l.jsx)("div",{ref:x})]}),(0,l.jsx)("div",{className:"p-4 border-t ".concat(s.is_romantic?"border-pink-200 bg-gradient-to-r from-pink-50 to-red-50":"border-gray-200"),children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("input",{type:"text",value:d,onChange:e=>c(e.target.value),onKeyPress:e=>"Enter"===e.key&&b(),placeholder:"Type a message...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-full focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,l.jsx)("button",{onClick:b,disabled:!d.trim(),className:"p-2 text-white rounded-full transition-colors disabled:opacity-50 ".concat(s.is_romantic?"bg-gradient-to-r from-pink-500 to-red-500 hover:from-pink-600 hover:to-red-600":"bg-blue-500 hover:bg-blue-600"),children:s.is_romantic?"\uD83D\uDC95":(0,l.jsx)(C.Z,{className:"w-4 h-4"})})]})})]}):(0,l.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDCAC"}),(0,l.jsx)("div",{className:"text-xl font-semibold mb-2",children:"Select a conversation"})]})})})]})}var E=a(3113);function P(e){let{user:t,onClose:a}=e,[s,i]=(0,r.useState)({followers:0,following:0,likes:0}),[n,o]=(0,r.useState)([]);return(0,r.useEffect)(()=>{(async()=>{try{let[e,a]=await Promise.all([(0,f.X_)(t.id),(0,f.ww)(t.id)]);i(e),o(a)}catch(e){console.error("Error loading user data:",e)}})()},[t.id]),(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full mx-4 max-h-[80vh] overflow-y-auto",children:[(0,l.jsxs)("div",{className:"text-center mb-6",children:[(0,l.jsx)("div",{className:"w-24 h-24 rounded-full overflow-hidden mx-auto bg-gradient-to-r from-primary-500 to-accent-500 p-1 mb-4",children:(0,l.jsx)("div",{className:"w-full h-full rounded-full overflow-hidden bg-white",children:t.profile_image_url?(0,l.jsx)("img",{src:t.profile_image_url,alt:t.name,className:"w-full h-full object-cover"}):(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center text-primary-500 text-2xl font-bold",children:t.name.charAt(0)})})}),(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:t.name}),(0,l.jsxs)("p",{className:"text-gray-600 mb-4",children:[t.current_city,", ",t.current_district]}),(0,l.jsxs)("div",{className:"flex justify-center gap-8 mb-6",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-xl font-bold text-gray-800",children:s.followers}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Followers"})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-xl font-bold text-gray-800",children:s.following}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Following"})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-xl font-bold text-gray-800",children:n.length}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Posts"})]})]}),n.length>0&&(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h3",{className:"font-semibold text-gray-800 mb-3",children:"Recent Posts"}),(0,l.jsx)("div",{className:"space-y-3 max-h-40 overflow-y-auto",children:n.slice(0,3).map(e=>(0,l.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3 text-left",children:[(0,l.jsx)("p",{className:"text-sm text-gray-700",children:e.content}),e.location_tag&&(0,l.jsxs)("p",{className:"text-xs text-primary-600 mt-1",children:["\uD83D\uDCCD ",e.location_tag]}),(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:new Date(e.created_at).toLocaleDateString()})]},e.id))})]})]}),(0,l.jsx)("button",{onClick:a,className:"w-full bg-gradient-to-r from-gray-500 to-gray-600 text-white py-3 rounded-2xl font-semibold",children:"Close"})]})})}function q(e){let{locationName:t}=e,{user:a}=(0,p.a)(),[s,i]=(0,r.useState)({average:0,count:0}),[n,o]=(0,r.useState)(0);(0,r.useEffect)(()=>{d()},[t]);let d=async()=>{try{let e=await (0,f.zp)(t);i(e)}catch(e){console.error("Error loading rating:",e)}},c=async e=>{if(null==a?void 0:a.id)try{await (0,f.lR)(a.id,t,e),o(e),d()}catch(e){console.error("Error rating location:",e)}};return(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,l.jsx)("div",{className:"flex",children:[1,2,3,4,5].map(e=>(0,l.jsx)("button",{onClick:()=>c(e),className:"text-lg ".concat(e<=s.average?"text-yellow-400":"text-gray-300"," hover:text-yellow-400"),children:"★"},e))}),(0,l.jsxs)("span",{className:"text-gray-600",children:[s.average.toFixed(1)," (",s.count," ratings)"]})]})}function A(){let{user:e}=(0,p.a)(),[t,a]=(0,r.useState)([]),[s,n]=(0,r.useState)(!0),[o,d]=(0,r.useState)(""),[c,u]=(0,r.useState)(""),[m,x]=(0,r.useState)(null),[h,g]=(0,r.useState)(null),[b,v]=(0,r.useState)(null),[j,w]=(0,r.useState)(null),N=(0,r.useRef)(null);(0,r.useEffect)(()=>{_()},[]);let _=async()=>{try{let e=await (0,f.Jq)();a(e)}catch(e){console.error("Error loading posts:",e)}finally{n(!1)}},k=async()=>{if((null==e?void 0:e.id)&&o.trim())try{await (0,f.qb)(e.id,o,c||void 0,h||void 0),d(""),u(""),g(null),v(null),_()}catch(e){console.error("Error creating post:",e),alert("Failed to create post")}};return s?(0,l.jsx)("div",{className:"space-y-6",children:[void 0,void 0,void 0].map((e,t)=>(0,l.jsxs)("div",{className:"bg-white rounded-3xl p-6 animate-pulse",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-gray-300 rounded-full"}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("div",{className:"h-4 bg-gray-300 rounded mb-2"}),(0,l.jsx)("div",{className:"h-3 bg-gray-300 rounded w-1/2"})]})]}),(0,l.jsx)("div",{className:"h-20 bg-gray-300 rounded"})]},t))}):(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"bg-white/90 backdrop-blur-md rounded-3xl shadow-xl p-6",children:[(0,l.jsx)("h3",{className:"text-xl font-bold mb-4",children:"Share with Community"}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("textarea",{value:o,onChange:e=>d(e.target.value),placeholder:"Share your travel experience...",className:"w-full p-4 border border-gray-300 rounded-2xl focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none",rows:3}),(0,l.jsxs)("div",{className:"flex gap-3",children:[(0,l.jsxs)("div",{className:"flex-1 relative",children:[(0,l.jsx)(i.Z,{className:"absolute left-3 top-3 w-4 h-4 text-gray-400"}),(0,l.jsx)("input",{type:"text",value:c,onChange:e=>u(e.target.value),placeholder:"Tag a location (optional)",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)("button",{type:"button",onClick:()=>{var e;return null===(e=N.current)||void 0===e?void 0:e.click()},className:"bg-gray-500 text-white px-4 py-3 rounded-xl hover:bg-gray-600 flex items-center gap-2",children:[(0,l.jsx)(E.Z,{className:"w-4 h-4"}),"Image"]}),(0,l.jsxs)("button",{onClick:k,disabled:!o.trim(),className:"bg-gradient-to-r from-primary-500 to-accent-500 text-white px-6 py-3 rounded-xl hover:shadow-lg transition-all duration-300 flex items-center gap-2 disabled:opacity-50",children:[(0,l.jsx)(C.Z,{className:"w-4 h-4"}),"Post"]})]}),(0,l.jsx)("input",{ref:N,type:"file",accept:"image/*",onChange:e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!a)return;if(a.size>5242880){alert("Image must be less than 5MB");return}g(a);let l=new FileReader;l.onload=e=>{var t;return v(null===(t=e.target)||void 0===t?void 0:t.result)},l.readAsDataURL(a)},className:"hidden"})]}),b&&(0,l.jsxs)("div",{className:"mt-4 relative",children:[(0,l.jsx)("img",{src:b,alt:"Preview",className:"max-w-full h-32 object-cover rounded-lg"}),(0,l.jsx)("button",{onClick:()=>{g(null),v(null),N.current&&(N.current.value="")},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:(0,l.jsx)(y.Z,{className:"w-4 h-4"})})]})]})]}),(0,l.jsxs)("div",{className:"space-y-6",children:[t.map(e=>(0,l.jsxs)("div",{className:"bg-white/90 backdrop-blur-md rounded-3xl shadow-xl p-6 hover:shadow-2xl transition-all duration-300",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,l.jsx)("button",{onClick:()=>x(e.user),className:"w-12 h-12 rounded-full overflow-hidden bg-gradient-to-r from-primary-500 to-accent-500 p-1 hover:scale-105 transition-transform",children:(0,l.jsx)("div",{className:"w-full h-full rounded-full overflow-hidden bg-white",children:e.user.profile_image_url?(0,l.jsx)("img",{src:e.user.profile_image_url,alt:e.user.name,className:"w-full h-full object-cover"}):(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center text-primary-500 text-lg font-bold",children:e.user.name.charAt(0)})})}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("button",{onClick:()=>x(e.user),className:"font-semibold text-gray-800 hover:text-primary-600 transition-colors",children:e.user.name}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:[e.user.current_city,", ",e.user.current_district]}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleDateString()})]})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("p",{className:"text-gray-800 leading-relaxed",children:e.content}),e.image_url&&(0,l.jsx)("img",{src:e.image_url,alt:"Post image",className:"w-full max-h-64 object-cover rounded-lg mt-3 cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>w(e.image_url||null)})]}),e.location_tag&&(0,l.jsxs)("div",{className:"bg-gradient-to-r from-primary-50 to-accent-50 rounded-2xl p-4 border border-primary-200",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,l.jsx)(i.Z,{className:"w-4 h-4 text-primary-600"}),(0,l.jsx)("span",{className:"font-semibold text-primary-800",children:e.location_tag})]}),(0,l.jsx)(q,{locationName:e.location_tag})]})]},e.id)),0===t.length&&(0,l.jsxs)("div",{className:"text-center py-12",children:[(0,l.jsx)("div",{className:"text-gray-400 text-lg",children:"No posts yet"}),(0,l.jsx)("p",{className:"text-gray-500 mt-2",children:"Be the first to share your travel experience!"})]})]}),m&&(0,l.jsx)(P,{user:m,onClose:()=>x(null)}),j&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 cursor-pointer",onClick:()=>w(null),children:(0,l.jsx)("img",{src:j,alt:"Enlarged",className:"max-w-[90vw] max-h-[90vh] object-contain"})})]})}var Z=a(9397),F=a(4630);function T(){let{user:e}=(0,p.a)(),[t,a]=(0,r.useState)([]),[s,n]=(0,r.useState)(!0),[o,d]=(0,r.useState)(!1),[u,m]=(0,r.useState)({destination:"",district:"",start_date:"",end_date:"",travel_type:"leisure",description:""});(0,r.useEffect)(()=>{(null==e?void 0:e.id)&&x()},[e]);let x=async()=>{if(null==e?void 0:e.id)try{let t=await (0,f.xT)(e.id);a(t)}catch(e){console.error("Error loading travel plans:",e)}finally{n(!1)}},h=async t=>{if(t.preventDefault(),null==e?void 0:e.id)try{await (0,f.SH)({...u,user_id:e.id,is_active:!0}),m({destination:"",district:"",start_date:"",end_date:"",travel_type:"leisure",description:""}),d(!1),x()}catch(e){console.error("Error creating travel plan:",e)}};return s?(0,l.jsx)("div",{className:"space-y-6",children:[void 0,void 0,void 0].map((e,t)=>(0,l.jsxs)("div",{className:"bg-white rounded-3xl p-6 animate-pulse",children:[(0,l.jsx)("div",{className:"h-6 bg-gray-300 rounded mb-4"}),(0,l.jsx)("div",{className:"h-4 bg-gray-300 rounded mb-2"}),(0,l.jsx)("div",{className:"h-4 bg-gray-300 rounded w-1/2"})]},t))}):(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Trip Planner"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Plan your Kerala adventures"})]}),(0,l.jsxs)("button",{onClick:()=>d(!0),className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white px-6 py-3 rounded-2xl hover:shadow-lg transition-all flex items-center gap-2",children:[(0,l.jsx)(Z.Z,{className:"w-5 h-5"}),"New Trip"]})]}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:t.map(e=>(0,l.jsxs)("div",{className:"bg-white/90 backdrop-blur-md rounded-3xl shadow-xl p-6 hover:shadow-2xl transition-all duration-300",children:[(0,l.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-1",children:j(e.destination)}),(0,l.jsxs)("div",{className:"flex items-center text-gray-600 text-sm",children:[(0,l.jsx)(i.Z,{className:"w-4 h-4 mr-1"}),j(e.district)]})]}),(0,l.jsx)("span",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium",children:e.travel_type})]}),(0,l.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-4 mb-4",children:(0,l.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center text-blue-700",children:[(0,l.jsx)(c.Z,{className:"w-4 h-4 mr-1"}),new Date(e.start_date).toLocaleDateString()]}),(0,l.jsx)("div",{className:"text-gray-500",children:"→"}),(0,l.jsxs)("div",{className:"flex items-center text-purple-700",children:[(0,l.jsx)(c.Z,{className:"w-4 h-4 mr-1"}),new Date(e.end_date).toLocaleDateString()]})]})}),e.description&&(0,l.jsx)("p",{className:"text-gray-700 text-sm mb-4",children:j(e.description)}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{className:"flex-1 bg-gradient-to-r from-green-500 to-teal-500 text-white py-2 px-4 rounded-xl text-sm font-medium hover:shadow-lg transition-all",children:"View Details"}),(0,l.jsx)("button",{className:"bg-gray-500 text-white p-2 rounded-xl hover:bg-gray-600 transition-colors",children:(0,l.jsx)(F.Z,{className:"w-4 h-4"})})]})]},e.id))}),0===t.length&&(0,l.jsxs)("div",{className:"text-center py-12",children:[(0,l.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDDFA️"}),(0,l.jsx)("div",{className:"text-gray-400 text-lg",children:"No travel plans yet"}),(0,l.jsx)("p",{className:"text-gray-500 mt-2",children:"Create your first Kerala adventure!"})]}),o&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-3xl p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsx)("h3",{className:"text-xl font-bold",children:"New Travel Plan"}),(0,l.jsx)("button",{onClick:()=>d(!1),children:(0,l.jsx)(y.Z,{className:"w-6 h-6"})})]}),(0,l.jsxs)("form",{onSubmit:h,className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Destination"}),(0,l.jsx)("input",{type:"text",value:u.destination,onChange:e=>m({...u,destination:e.target.value}),className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"District"}),(0,l.jsxs)("select",{value:u.district,onChange:e=>m({...u,district:e.target.value}),className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[(0,l.jsx)("option",{value:"",children:"Select District"}),(0,l.jsx)("option",{value:"Thiruvananthapuram",children:"Thiruvananthapuram"}),(0,l.jsx)("option",{value:"Kollam",children:"Kollam"}),(0,l.jsx)("option",{value:"Pathanamthitta",children:"Pathanamthitta"}),(0,l.jsx)("option",{value:"Alappuzha",children:"Alappuzha"}),(0,l.jsx)("option",{value:"Kottayam",children:"Kottayam"}),(0,l.jsx)("option",{value:"Idukki",children:"Idukki"}),(0,l.jsx)("option",{value:"Ernakulam",children:"Ernakulam"}),(0,l.jsx)("option",{value:"Thrissur",children:"Thrissur"}),(0,l.jsx)("option",{value:"Palakkad",children:"Palakkad"}),(0,l.jsx)("option",{value:"Malappuram",children:"Malappuram"}),(0,l.jsx)("option",{value:"Kozhikode",children:"Kozhikode"}),(0,l.jsx)("option",{value:"Wayanad",children:"Wayanad"}),(0,l.jsx)("option",{value:"Kannur",children:"Kannur"}),(0,l.jsx)("option",{value:"Kasaragod",children:"Kasaragod"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Start Date"}),(0,l.jsx)("input",{type:"date",value:u.start_date,onChange:e=>m({...u,start_date:e.target.value}),className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"End Date"}),(0,l.jsx)("input",{type:"date",value:u.end_date,onChange:e=>m({...u,end_date:e.target.value}),className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Travel Type"}),(0,l.jsxs)("select",{value:u.travel_type,onChange:e=>m({...u,travel_type:e.target.value}),className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:"leisure",children:"Leisure"}),(0,l.jsx)("option",{value:"adventure",children:"Adventure"}),(0,l.jsx)("option",{value:"cultural",children:"Cultural"}),(0,l.jsx)("option",{value:"business",children:"Business"}),(0,l.jsx)("option",{value:"family",children:"Family"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Description"}),(0,l.jsx)("textarea",{value:u.description,onChange:e=>m({...u,description:e.target.value}),className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 h-20",placeholder:"Describe your travel plans..."})]}),(0,l.jsx)("button",{type:"submit",className:"w-full bg-gradient-to-r from-blue-500 to-purple-500 text-white py-3 rounded-lg font-semibold hover:shadow-lg transition-all",children:"Create Plan"})]})]})})]})}var I=a(2208);function L(){let{user:e}=(0,p.a)(),[t,a]=(0,r.useState)([]),[s,i]=(0,r.useState)(!0),[n,o]=(0,r.useState)("all"),[d,c]=(0,r.useState)("all");(0,r.useEffect)(()=>{u()},[]);let u=async()=>{try{let e=await (0,f.dZ)({type:n,district:d});a(e)}catch(e){console.error("Error loading locations:",e)}finally{i(!1)}};return((0,r.useEffect)(()=>{u()},[n,d]),s)?(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((e,t)=>(0,l.jsxs)("div",{className:"bg-white rounded-3xl p-6 animate-pulse",children:[(0,l.jsx)("div",{className:"h-40 bg-gray-300 rounded-2xl mb-4"}),(0,l.jsx)("div",{className:"h-6 bg-gray-300 rounded mb-2"}),(0,l.jsx)("div",{className:"h-4 bg-gray-300 rounded"})]},t))}):(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:[{key:"all",label:"All Places",emoji:"\uD83C\uDF0D"},{key:"backwater",label:"Backwaters",emoji:"\uD83D\uDEA4"},{key:"hillstation",label:"Hill Stations",emoji:"⛰️"},{key:"beach",label:"Beaches",emoji:"\uD83C\uDFD6️"},{key:"cultural",label:"Cultural",emoji:"\uD83C\uDFDB️"}].map(e=>(0,l.jsxs)("button",{onClick:()=>o(e.key),className:"px-4 py-2 rounded-full text-sm font-medium transition-all ".concat(n===e.key?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-200"),children:[e.emoji," ",e.label]},e.key))}),(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsxs)("select",{value:d,onChange:e=>c(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:"all",children:"All Districts"}),["Thiruvananthapuram","Kollam","Pathanamthitta","Alappuzha","Kottayam","Idukki","Ernakulam","Thrissur","Palakkad","Malappuram","Kozhikode","Wayanad","Kannur","Kasaragod"].map(e=>(0,l.jsx)("option",{value:e,children:e},e))]}),(0,l.jsx)("button",{onClick:()=>{o("all"),c("all")},className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Clear Filters"})]})]}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(t=>(0,l.jsx)(z,{location:t,user:e},t.id))}),0===t.length&&(0,l.jsxs)("div",{className:"text-center py-12",children:[(0,l.jsx)("div",{className:"text-gray-400 text-lg",children:"No locations found"}),(0,l.jsx)("p",{className:"text-gray-500 mt-2",children:"Try selecting a different category"})]})]})}function z(e){let{location:t,user:a}=e,[s,n]=(0,r.useState)({average:0,count:0}),[o,d]=(0,r.useState)(!1);(0,r.useEffect)(()=>{c()},[t.name]);let c=async()=>{try{let e=await (0,f.zp)(t.name);n(e)}catch(e){console.error("Error loading rating:",e)}},u=async e=>{if(null==a?void 0:a.id)try{await (0,f.lR)(a.id,t.name,e),c()}catch(e){console.error("Error rating location:",e)}},m=async()=>{if(null==a?void 0:a.id){d(!0);try{await (0,f.ez)(a.id,t.name,t.district),alert("Added ".concat(t.name," to your travel plans!"))}catch(e){console.error("Error adding to travel plan:",e),alert("Failed to add to travel plan")}finally{d(!1)}}},x={backwater:"\uD83D\uDEA4",hillstation:"⛰️",beach:"\uD83C\uDFD6️",cultural:"\uD83C\uDFDB️"};return(0,l.jsxs)("div",{className:"bg-white/90 backdrop-blur-md rounded-3xl shadow-xl hover:shadow-2xl transition-all duration-500 overflow-hidden group",children:[(0,l.jsxs)("div",{className:"relative h-48 overflow-hidden",children:[t.image_url?(0,l.jsx)("img",{src:t.image_url,alt:t.name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"}):(0,l.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-6xl",children:x[t.type]||"\uD83C\uDF0D"})}),t.is_featured&&(0,l.jsx)("div",{className:"absolute top-4 right-4 bg-yellow-500 text-white px-3 py-1 rounded-full text-sm font-bold",children:"⭐ Featured"})]}),(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-1",children:j(t.name)}),(0,l.jsxs)("div",{className:"flex items-center text-gray-600 text-sm",children:[(0,l.jsx)(i.Z,{className:"w-4 h-4 mr-1"}),j(t.district)]})]}),(0,l.jsx)("span",{className:"text-2xl",children:x[t.type]||"\uD83C\uDF0D"})]}),(0,l.jsx)("p",{className:"text-gray-700 text-sm mb-4 line-clamp-3",children:j(t.description)}),(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsx)("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(e=>(0,l.jsx)("button",{onClick:()=>u(e),className:"text-lg ".concat(e<=s.average?"text-yellow-400":"text-gray-300"," hover:text-yellow-400 transition-colors"),children:"★"},e))}),(0,l.jsxs)("span",{className:"text-sm text-gray-600",children:[s.average.toFixed(1)," (",s.count,")"]})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[t.virtual_tour_url&&(0,l.jsxs)("a",{href:t.virtual_tour_url,target:"_blank",rel:"noopener noreferrer",className:"flex-1 bg-gradient-to-r from-green-500 to-teal-500 text-white py-2 px-4 rounded-xl text-center text-sm font-medium hover:shadow-lg transition-all flex items-center justify-center gap-2",children:[(0,l.jsx)(I.Z,{className:"w-4 h-4"}),"Virtual Tour"]}),(0,l.jsx)("button",{onClick:m,disabled:o,className:"flex-1 bg-gradient-to-r from-blue-500 to-purple-500 text-white py-2 px-4 rounded-xl text-sm font-medium hover:shadow-lg transition-all disabled:opacity-50",children:o?"Adding...":"Plan Visit"})]})]})]})}var O=a(7648);function K(){let{user:e}=(0,p.a)(),[t,a]=(0,r.useState)("live");if(!e)return(0,l.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-accent-50 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center bg-white p-8 rounded-3xl shadow-xl",children:[(0,l.jsx)(s.Z,{className:"w-16 h-16 text-primary-500 mx-auto mb-4"}),(0,l.jsx)("h2",{className:"text-3xl font-display font-bold mb-4 gradient-text",children:"Welcome to WanderMatch"}),(0,l.jsx)("p",{className:"text-gray-600 mb-6",children:"Please sign in to access your travel dashboard"}),(0,l.jsx)(O.default,{href:"/signin",className:"btn-primary",children:"Sign In to Continue"})]})});let x=[{id:"live",label:"Live Map",icon:i.Z,color:"from-green-500 to-teal-500"},{id:"following",label:"Following",icon:n.Z,color:"from-blue-500 to-purple-500"},{id:"matches",label:"Matches",icon:o.Z,color:"from-red-500 to-pink-500"},{id:"chat",label:"Messages",icon:d.Z,color:"from-purple-500 to-indigo-500"},{id:"community",label:"Community",icon:s.Z,color:"from-indigo-500 to-purple-500"},{id:"travelers",label:"Discover",icon:n.Z,color:"from-orange-500 to-amber-500"},{id:"planner",label:"Trip Planner",icon:c.Z,color:"from-cyan-500 to-blue-500"},{id:"locations",label:"Locations",icon:u.Z,color:"from-emerald-500 to-green-500"}];return(0,l.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-accent-50",children:[(0,l.jsx)("div",{className:"bg-white/95 backdrop-blur-md shadow-lg border-b border-gray-100",children:(0,l.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,l.jsxs)("div",{className:"flex items-center justify-between py-6",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{className:"w-16 h-16 rounded-full overflow-hidden bg-gradient-to-r from-primary-500 to-accent-500 p-1",children:(0,l.jsx)("div",{className:"w-full h-full rounded-full overflow-hidden bg-white",children:e.profile_image_url?(0,l.jsx)("img",{src:e.profile_image_url,alt:e.name,className:"w-full h-full object-cover"}):(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center text-primary-500 text-xl font-bold",children:e.name.charAt(0)})})}),(0,l.jsx)("div",{className:"absolute -bottom-1 -right-1 w-5 h-5 bg-green-500 rounded-full border-2 border-white"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("h1",{className:"text-2xl font-display font-bold gradient-text",children:["Welcome back, ",e.name,"!"]}),(0,l.jsxs)("div",{className:"flex items-center text-gray-600 mt-1",children:[(0,l.jsx)(i.Z,{className:"w-4 h-4 mr-1"}),(0,l.jsxs)("span",{children:[e.current_city,", ",e.current_district]})]})]})]}),(0,l.jsx)("div",{className:"flex items-center space-x-3",children:(0,l.jsxs)(O.default,{href:"/profile",className:"btn-secondary flex items-center space-x-2",children:[(0,l.jsx)(m.Z,{className:"w-4 h-4"}),(0,l.jsx)("span",{children:"Profile"})]})})]})})}),(0,l.jsx)("div",{className:"bg-white/80 backdrop-blur-md border-b border-gray-200",children:(0,l.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,l.jsx)("nav",{className:"flex space-x-1",children:x.map(e=>{let r=e.icon;return(0,l.jsxs)("button",{onClick:()=>a(e.id),className:"flex items-center space-x-3 py-4 px-6 font-medium text-sm transition-all duration-300 rounded-t-2xl relative ".concat(t===e.id?"bg-white text-primary-600 shadow-lg transform -translate-y-1":"text-gray-600 hover:text-primary-600 hover:bg-white/50"),children:[(0,l.jsx)("div",{className:"p-2 rounded-xl bg-gradient-to-r ".concat(e.color," ").concat(t===e.id?"text-white":"text-white/70"),children:(0,l.jsx)(r,{className:"w-4 h-4"})}),(0,l.jsx)("span",{className:"font-semibold",children:e.label}),t===e.id&&(0,l.jsx)("div",{className:"absolute bottom-0 left-1/2 transform -translate-x-1/2 w-12 h-1 bg-gradient-to-r from-primary-500 to-accent-500 rounded-full"})]},e.id)})})})}),(0,l.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,l.jsxs)("div",{className:"bg-white/80 backdrop-blur-md rounded-3xl shadow-xl p-8",children:["live"===t&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"mb-8 text-center",children:[(0,l.jsx)("h2",{className:"text-4xl font-display font-bold gradient-text mb-3",children:"Live Travelers Map"}),(0,l.jsx)("p",{className:"text-gray-600 text-lg",children:"See who's online and exploring right now across Kerala"})]}),(0,l.jsx)(D,{})]}),"following"===t&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"mb-8 text-center",children:[(0,l.jsx)("h2",{className:"text-4xl font-display font-bold gradient-text mb-3",children:"People You Follow"}),(0,l.jsx)("p",{className:"text-gray-600 text-lg",children:"Your travel connections and favorite explorers"})]}),(0,l.jsx)(k,{onSwitchToChat:()=>a("chat")})]}),"matches"===t&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"mb-8 text-center",children:[(0,l.jsx)("h2",{className:"text-4xl font-display font-bold gradient-text mb-3",children:"Your Travel Matches"}),(0,l.jsx)("p",{className:"text-gray-600 text-lg",children:"People who liked you back - mutual connections!"})]}),(0,l.jsx)(_,{onSwitchToChat:()=>a("chat")})]}),"chat"===t&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"mb-8 text-center",children:[(0,l.jsx)("h2",{className:"text-4xl font-display font-bold gradient-text mb-3",children:"Your Conversations"}),(0,l.jsx)("p",{className:"text-gray-600 text-lg",children:"Chat with your travel connections and plan amazing adventures"})]}),(0,l.jsx)(S,{})]}),"community"===t&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"mb-8 text-center",children:[(0,l.jsx)("h2",{className:"text-4xl font-display font-bold gradient-text mb-3",children:"Community Posts"}),(0,l.jsx)("p",{className:"text-gray-600 text-lg",children:"Share experiences and discover amazing places"})]}),(0,l.jsx)(A,{})]}),"travelers"===t&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"mb-8 text-center",children:[(0,l.jsx)("h2",{className:"text-4xl font-display font-bold gradient-text mb-3",children:"Discover Amazing Travelers"}),(0,l.jsx)("p",{className:"text-gray-600 text-lg",children:"Follow fellow adventurers and local guides across Kerala"})]}),(0,l.jsx)(v,{onSwitchToChat:()=>a("chat")})]}),"planner"===t&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"mb-8 text-center",children:[(0,l.jsx)("h2",{className:"text-4xl font-display font-bold gradient-text mb-3",children:"Trip Planner"}),(0,l.jsx)("p",{className:"text-gray-600 text-lg",children:"Plan your perfect Kerala adventure"})]}),(0,l.jsx)(T,{})]}),"locations"===t&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"mb-8 text-center",children:[(0,l.jsx)("h2",{className:"text-4xl font-display font-bold gradient-text mb-3",children:"Kerala Locations"}),(0,l.jsx)("p",{className:"text-gray-600 text-lg",children:"Discover God's Own Country"})]}),(0,l.jsx)(L,{})]})]})})]})}},1265:function(e,t,a){"use strict";a.d(t,{a:function(){return n},default:function(){return o}});var l=a(7437),r=a(2265),s=a(2141);let i=(0,r.createContext)({user:null,loading:!0,signOut:async()=>{},setUser:()=>{},signUp:async()=>({error:"Not implemented"}),signIn:async()=>({error:"Not implemented"})}),n=()=>{let e=(0,r.useContext)(i);if(!e)throw Error("useAuth must be used within AuthProvider");return e};function o(e){let{children:t}=e,[a,n]=(0,r.useState)(null),[o,d]=(0,r.useState)(!0);(0,r.useEffect)(()=>{(async()=>{let{data:{session:e}}=await s.OQ.auth.getSession();if(null==e?void 0:e.user){let{data:t}=await s.OQ.from("users").select("*").eq("id",e.user.id).single();t&&(await (0,s.yA)(t.id,!0),n({...t,is_online:!0}))}d(!1)})();let{data:{subscription:e}}=s.OQ.auth.onAuthStateChange(async(e,t)=>{if(null==t?void 0:t.user){let{data:e}=await s.OQ.from("users").select("*").eq("id",t.user.id).single();e&&(await (0,s.yA)(e.id,!0),n({...e,is_online:!0}))}else n(null);d(!1)});return()=>e.unsubscribe()},[]);let c=async()=>{a&&await (0,s.yA)(a.id,!1),await s.OQ.auth.signOut(),n(null)},u=async(e,t,a)=>{try{let{data:l,error:r}=await s.OQ.auth.signUp({email:e,password:t,options:{data:a,emailRedirectTo:void 0}});if(r)return console.error("Signup error:",r),{error:r.message};return console.log("Signup successful:",l),{error:void 0}}catch(e){return console.error("Signup exception:",e),{error:"Signup failed"}}},m=async(e,t)=>{try{let{data:a,error:l}=await s.OQ.auth.signInWithPassword({email:e,password:t});if(l)return{error:l.message};return{error:void 0}}catch(e){return{error:"Login failed"}}};return(0,l.jsx)(i.Provider,{value:{user:a,loading:o,signOut:c,setUser:n,signUp:u,signIn:m},children:t})}},2141:function(e,t,a){"use strict";a.d(t,{AJ:function(){return b},AW:function(){return x},Bp:function(){return N},DJ:function(){return w},EF:function(){return v},ET:function(){return p},F6:function(){return g},GA:function(){return I},Jq:function(){return P},Lj:function(){return u},OQ:function(){return i},P_:function(){return h},SH:function(){return d},X_:function(){return A},_p:function(){return m},b6:function(){return C},bE:function(){return S},createChatRoom:function(){return k},dZ:function(){return n},di:function(){return D},ez:function(){return c},ip:function(){return y},isMutualLike:function(){return L},lR:function(){return Z},nX:function(){return f},oB:function(){return j},qb:function(){return E},ww:function(){return q},xT:function(){return o},yA:function(){return T},zp:function(){return F}});var l=a(8439);let r="https://rbhdvffmsgjhorzubghj.supabase.co",s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJiaGR2ZmZtc2dqaG9yenViZ2hqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY2NDI2NDcsImV4cCI6MjA3MjIxODY0N30.y_8P2L6esbjRfRc7LcfphLSL9GEMh5Vw_mlY0EePBpg";if(!r||!s)throw Error("Missing Supabase environment variables. Please check your .env.local file.");if(r.includes("your_supabase_project_url_here"))throw Error("Please update your Supabase URL in .env.local with your actual project URL");let i=(0,l.eI)(r,s),n=async e=>{let t=i.from("kerala_locations").select("*").order("is_featured",{ascending:!1});(null==e?void 0:e.type)&&"all"!==e.type&&(t=t.eq("type",e.type)),(null==e?void 0:e.district)&&"all"!==e.district&&(t=t.eq("district",e.district));let{data:a,error:l}=await t;if(l)throw l;return a},o=async e=>{let{data:t,error:a}=await i.from("travel_plans").select("*").eq("user_id",e).eq("is_active",!0);if(a)throw a;return t},d=async e=>{let{data:t,error:a}=await i.from("travel_plans").insert([e]).select().single();if(a)throw a;return t};async function c(e,t,a){let l={user_id:e,destination:t,district:a,start_date:new Date().toISOString().split("T")[0],end_date:new Date(Date.now()+6048e5).toISOString().split("T")[0],travel_type:"leisure",description:"Visit ".concat(t),is_active:!0};return await d(l)}async function u(e,t){let{interests:a,...l}=t,{data:r,error:s}=await i.from("users").update(l).eq("id",e).select().single();if(s)throw s;return r}async function m(e,t){if(t.size>5242880)throw Error("File size must be less than 5MB");if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(t.type))throw Error("Only JPEG, PNG, and WebP images are allowed");let a=t.name.split(".").pop(),l="".concat(e,"-").concat(Date.now(),".").concat(a),r="profile-images/".concat(l),{error:s}=await i.storage.from("profile-images").upload(r,t);if(s)throw s;let{data:n}=i.storage.from("profile-images").getPublicUrl(r);return n.publicUrl}async function x(){let{data:e,error:t}=await i.from("users").select("*").order("created_at",{ascending:!1});if(t)throw t;return e}async function h(e,t){let{data:a,error:l}=await i.from("user_follows").insert([{follower_id:e,following_id:t}]).select().single();if(l)throw l;return a}async function g(e,t){let{error:a}=await i.from("user_follows").delete().eq("follower_id",e).eq("following_id",t);if(a)throw a}async function f(e){let{data:t,error:a}=await i.from("user_follows").select("\n      following_id,\n      following:users!user_follows_following_id_fkey(*)\n    ").eq("follower_id",e);if(a)throw a;return t.map(e=>({...e.following,is_online:e.following.is_online||!1}))}async function p(e){let{data:t,error:a}=await i.from("user_follows").select("\n      follower_id,\n      follower:users!user_follows_follower_id_fkey(*)\n    ").eq("following_id",e);if(a)throw a;return t.map(e=>e.follower)}async function b(e,t){let{data:a,error:l}=await i.from("user_follows").select("id").eq("follower_id",e).eq("following_id",t).single();if(l&&"PGRST116"!==l.code)throw l;return!!a}async function v(e,t){let{data:a,error:l}=await i.from("user_likes").insert([{liker_id:e,liked_id:t}]).select().single();if(l)throw l;try{let{data:a,error:l}=await i.from("user_likes").select("id").eq("liker_id",t).eq("liked_id",e).single();if(a&&!l){await _(e,t);let a=await k(e,t,!0);console.log("Romantic chat room created:",a)}}catch(e){console.error("Error checking mutual like:",e)}return a}async function j(e,t){let{error:a}=await i.from("user_likes").delete().eq("liker_id",e).eq("liked_id",t);if(a)throw a;await i.from("matches").delete().or("and(user1_id.eq.".concat(e,",user2_id.eq.").concat(t,"),and(user1_id.eq.").concat(t,",user2_id.eq.").concat(e,")"))}async function y(e,t){let{data:a,error:l}=await i.from("user_likes").select("id").eq("liker_id",e).eq("liked_id",t).single();if(l&&"PGRST116"!==l.code)throw l;return!!a}async function w(e){let{data:t,error:a}=await i.from("user_likes").select("\n      liked_id,\n      liked:users!user_likes_liked_id_fkey(*)\n    ").eq("liker_id",e);if(a)throw a;return t.map(e=>e.liked)}async function N(e){let{data:t,error:a}=await i.from("user_likes").select("\n      liker_id,\n      liker:users!user_likes_liker_id_fkey(*)\n    ").eq("liked_id",e);if(a)throw a;return t.map(e=>e.liker)}async function _(e,t){let{data:a,error:l}=await i.from("matches").insert([{user1_id:e,user2_id:t}]).select().single();if(l)throw l;return a}async function k(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{data:l}=await i.from("chat_rooms").select("*").or("and(participant1_id.eq.".concat(e,",participant2_id.eq.").concat(t,"),and(participant1_id.eq.").concat(t,",participant2_id.eq.").concat(e,")")).single();if(l){if(a&&!l.is_romantic){let{data:e,error:t}=await i.from("chat_rooms").update({is_romantic:!0}).eq("id",l.id).select().single();if(t)throw t;return e}return l}let{data:r,error:s}=await i.from("chat_rooms").insert([{participant1_id:e,participant2_id:t,is_romantic:a}]).select("\n      *,\n      participant1:users!chat_rooms_participant1_id_fkey(*),\n      participant2:users!chat_rooms_participant2_id_fkey(*)\n    ").single();if(s)throw s;return r}async function D(e){let{data:t,error:a}=await i.from("chat_rooms").select("\n      *,\n      participant1:users!chat_rooms_participant1_id_fkey(*),\n      participant2:users!chat_rooms_participant2_id_fkey(*)\n    ").or("participant1_id.eq.".concat(e,",participant2_id.eq.").concat(e)).order("last_message_time",{ascending:!1});if(a)throw a;return t}async function C(e){let{data:t,error:a}=await i.from("chat_messages").select("\n      *,\n      sender:users!chat_messages_sender_id_fkey(*)\n    ").eq("room_id",e).order("created_at",{ascending:!0});if(a)throw a;return t}async function S(e,t,a){let{data:l,error:r}=await i.from("chat_messages").insert([{room_id:e,sender_id:t,content:a}]).select().single();if(r)throw r;return await i.from("chat_rooms").update({last_message:a,last_message_time:new Date().toISOString()}).eq("id",e),l}async function E(e,t,a,l){let r=null;if(l){let t=l.name.split(".").pop(),a="".concat(e,"-").concat(Date.now(),".").concat(t),s="post-images/".concat(a),{error:n}=await i.storage.from("post-images").upload(s,l);if(n)throw n;let{data:o}=i.storage.from("post-images").getPublicUrl(s);r=o.publicUrl}let{data:s,error:n}=await i.from("posts").insert([{user_id:e,content:t,location_tag:a,image_url:r}]).select().single();if(n)throw n;return s}async function P(){let{data:e,error:t}=await i.from("posts").select("\n      *,\n      user:users!posts_user_id_fkey(*)\n    ").order("created_at",{ascending:!1});if(t)throw t;return e}async function q(e){let{data:t,error:a}=await i.from("posts").select("*").eq("user_id",e).order("created_at",{ascending:!1});if(a)throw a;return t}async function A(e){var t,a;let[l,r]=await Promise.all([i.from("user_follows").select("id").eq("following_id",e),i.from("user_follows").select("id").eq("follower_id",e)]);return{followers:(null===(t=l.data)||void 0===t?void 0:t.length)||0,following:(null===(a=r.data)||void 0===a?void 0:a.length)||0,likes:0}}async function Z(e,t,a){let{data:l,error:r}=await i.from("location_ratings").upsert([{user_id:e,location_name:t,rating:a}]).select().single();if(r)throw r;return l}async function F(e){let{data:t,error:a}=await i.from("location_ratings").select("rating").eq("location_name",e);if(a)throw a;if(!t||0===t.length)return{average:0,count:0};let l=t.map(e=>e.rating);return{average:Math.round(l.reduce((e,t)=>e+t,0)/l.length*10)/10,count:l.length}}async function T(e,t){let{error:a}=await i.from("users").update({is_online:t,last_seen:new Date().toISOString()}).eq("id",e);if(a)throw a}async function I(e){let{data:t,error:a}=await i.from("users").select("*").eq("id",e).single();if(a)throw a;return t}async function L(e,t){let[a,l]=await Promise.all([i.from("user_likes").select("id").eq("liker_id",e).eq("liked_id",t).single(),i.from("user_likes").select("id").eq("liker_id",t).eq("liked_id",e).single()]);return!!(a.data&&l.data)}}},function(e){e.O(0,[439,282,971,117,744],function(){return e(e.s=2763)}),_N_E=e.O()}]);